#!/bin/bash

# Detect the current shell
get_shell() {
    case "${SHELL}" in
        *bash*) shell=Bash;;
        *zsh*)  shell=Zsh;;
        *)      shell=Unknown;;
    esac
    echo "${shell}"
}
current_shell=$(get_shell)
case "${current_shell}" in
    Bash)   
        shell_rc="${HOME}/.bashrc"
        ;;
    Zsh)    
        shell_rc="${HOME}/.zshrc"
        ;;
    *)
        echo "Unsupported shell: ${current_shell}"
        exit 1
        ;;
esac

# Detect the current operating system
get_os() {
    uname_out="$(uname -s)"
    case "${uname_out}" in
        Linux*)     os=Linux;;
        Darwin*)    os=Mac;;
        *)          os="UNKNOWN:${uname_out}"
    esac
    echo "${os}"
}
current_os=$(get_os)
case "${current_os}" in
    Linux)  
        binary_path="/usr/local/bin/redis-exploit"
        ;;
    Mac)    
        binary_path="/usr/local/bin/redis-exploit"
        ;;
    *)      
        echo "Unsupported operating system: ${current_os}"
        exit 1
        ;;
esac

# Download the binary
wget https://github.com/mihneamanolache/redis-exploit/releases/download/colors/redis-exploit -O "${binary_path}"

# Make the binary executable
sudo chmod +x "${binary_path}"

# Add an alias for the binary command
echo "alias redis-exploit='${binary_path}'" >> "${shell_rc}"